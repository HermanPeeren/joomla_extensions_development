<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>1.&nbsp;Namespaces</title><link rel="stylesheet" type="text/css" href="html.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="Joomla Extensions Development"><link rel="up" href="ch02.html" title="Chapter&nbsp;2.&nbsp;Basic concepts"><link rel="prev" href="ch02.html" title="Chapter&nbsp;2.&nbsp;Basic concepts"><link rel="next" href="ch02s02.html" title="2.&nbsp;Dependency Injection Container / Service Locator"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">1.&nbsp;Namespaces</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch02.html"><img src="images/prev.svg" alt="Prev"></a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;2.&nbsp;Basic concepts</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch02s02.html"><img src="images/next.svg" alt="Next"></a></td></tr></table><hr></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="concepts-namespaces"></a>1.&nbsp;Namespaces</h2></div></div></div><p>The single most defining change in Joomla 4 is that Joomla embraces <a class="link" href="https://www.php.net/manual/en/language.namespaces.php" target="_top">PHP namespaces</a> everywhere: core, core extensions, third party extensions and everything in between.</p><h3><a name="d0e506"></a>The core</h3><p>The work on namespacing core Joomla API classes had started since Joomla 3.3. If you have not updated your code the last few years you may have found that it no longer works on Joomla 4. Do not despair! The vast majority of issues comes from your using outdated, non-namespaced versions of core classes in your code. Replacing them with their namespaced versions will let most Joomla 3&#8211;only extensions to run well enough in Joomla 4 for a migration to be practical.</p><p>I have collected the old, non-namespaced core classes and the new, namespaced names of them along with the Joomla version the namespaced versions appeared and the Joomla version the non-namespaced versions are or will be removed in <a class="link" href="https://github.com/nikosdion/joomlatypehints/blob/main/JoomlaObsoleteClasses.md" target="_top">my Joomla Type Hints</a> repository. The repository also includes <a class="link" href="https://getrector.org" target="_top">Rector</a> configurations which allow you to do most of the heavy lifting using an automated tool. For everything else you need some good old search and replace across your source trees.</p><h3><a name="d0e518"></a>The extensions</h3><p>The story of Joomla 4 began on the last day of May 2015 in Prague, Czech Republic at a round table discussion about the future of Joomla. A dozen or so leadership members, core contributors and third party developers sat down to figure out why Joomla &#8220;sucks&#8221; and how to improve it.</p><p>Beyond the user-facing issues, we found out that the core MVC and architecture were extremely dated. The core MVC started being developed in 2005 and made its first appearance in 2007, with Joomla 1.5. It had not changed much, despite some moderate improvements in Joomla 1.6 which was released in 2010 (e.g. XML Forms) and a few disparate things added here and there (e.g. Tags in 3.2, Layouts in 3.4 and so on). You could not reference frontend code from the backend or vice-versa. For third party extensions this was an annoyance which led to duplicated code and bugs. For using core code, like creating articles <span class="emphasis"><em>the right way</em></span> using <code class="code">com_content</code>'s Article model, it was nearly impossible: if you tried doing that on a page which had already loaded the front-end ContentModelArticle class you could no longer load the same-named but entirely differently operating backend class.</p><p>The way to solve that would be to <span class="emphasis"><em>namespace</em></span> the extensions' code. A com_example extension could have the namespace prefix \MyCompany\Example\Administrator for its backend classes and \MyCompany\Example\Site for its frontend classes. This way you could have something like:</p><pre class="programlisting">namespace \MyCompany\Example\Site\Model;

class ItemModel extends \MyCompany\Example\Administrator\Model\ItemModel
{
   // ...
}</pre><p>By being able to extend classes across application sides you would finally be able to get rid of duplicate code and obliterate bugs coming from that bad practice.</p><p>By following the <a class="link" href="https://www.php-fig.org/psr/psr-4/" target="_top">PSR-4</a> standard we could also have a very efficient autoloader which allows us to load any extension's classes from anywhere, without having to know where on the filesystem the class file lives and without having to use the ugly static methods of the core MVC classes (which, by the way, would NOT work predictably across extensions because of their dependence on the <code class="code">JPATH_COMPONENT_ADMINISTRATOR</code> and <code class="code">JPATH_COMPONENT</code> constants which cannot, of course, be redefined).</p><p>Each extension's namespace is declared in the XML manifest of the extension using a new XML element under the <code class="code">&lt;extension&gt;</code> root element:</p><pre class="programlisting">&lt;namespace path="src"&gt;My\Namespace\Prefix&lt;/namespace&gt;</pre><p>The <code class="code">path</code> attribute tells Joomla which subdirectory of your extension holds the PSR-4 of your extension's PHP files. It is best practice to name it <code class="filename">src</code> but <span class="emphasis"><em>you don't have to</em></span>. In the rest of this section I assume you are using <code class="filename">src</code>.</p><p>The text inside the XML element, <code class="code">My\Namespace\Prefix</code> in our example, is the namespace prefix you will be using.</p><p>Here is how namespace prefixes work across different types of extensions:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="bold"><strong>Component, frontend</strong></span>. Each component can register its own namespace prefix without any restrictions. It is <span class="emphasis"><em>recommended</em></span> to use the convention <code class="code">\Company\Something</code> where <code class="code">Company</code> is your company name (or a shortened version thereof) and <code class="code">Something</code> corresponds to the <code class="code">com_something</code> extension name of your component. For example, the component <code class="code">com_example</code> by Acme, Inc could have a namespace prefix of <code class="code">\Acme\Example</code> set up in its XML manifest. In this case its frontend classes MUST be under the namespace <code class="code">\Acme\Example\Site</code>. The folder <code class="filename">components/com_example/src</code> is the root of the <code class="code">\Acme\Example\Site</code> namespace.</p></li><li class="listitem"><p><span class="bold"><strong>Component, backend</strong></span>. Let's say we have the component <code class="code">com_example</code> by Acme, Inc which has a namespace prefix of <code class="code">\Acme\Example</code>. In this case its backend classes MUST be under the namespace <code class="code">\Acme\Example\Administrator</code>. The folder <code class="filename">administrator/components/com_example/src</code> is the root of the <code class="code">\Acme\Example\Administrator</code> namespace.</p></li><li class="listitem"><p><span class="bold"><strong>Component, API application</strong></span>. The API application is the third Joomla application (the other two being Site the frontend, and Administrator the backend). We'll talk about it <a class="link" href="ch03s24.html" title="24.&nbsp;The API application">later in this book</a>. Let's say we have the component <code class="code">com_example</code> by Acme, Inc which has a namespace prefix of <code class="code">\Acme\Example</code>. In this case its API application classes MUST be under the namespace <code class="code">\Acme\Example\Api</code>. The folder <code class="filename">api/components/com_example/src</code> is the root of the <code class="code">\Acme\Example\Api</code> namespace.</p></li><li class="listitem"><p><span class="bold"><strong>Module, frontend</strong></span>. A frontend module mod_example MUST have its classes under the namespace <code class="code">Joomla\Module\Example\Site</code>. The namespace you MUST declare in the XML manifest is <code class="code">Joomla\Module\Example</code>. Even though you are severely restricted in the namespace prefix you can use, you MUST provide it in your XML manifest or your module won't work! The folder <code class="filename">modules/mod_example/src</code> is the root of the <code class="code">Joomla\Module\Example\Site</code> namespace.</p></li><li class="listitem"><p><span class="bold"><strong>Module, backend</strong></span>. A backend module mod_example MUST have its classes under the namespace <code class="code">Joomla\Module\Example\Administrator</code>. The namespace you MUST declare in the XML manifest is <code class="code">Joomla\Module\Example</code>. Even though you are severely restricted in the namespace prefix you can use, you MUST provide it in your XML manifest or your module won't work! The folder <code class="filename">administrator/modules/mod_example/src</code> is the root of the <code class="code">Joomla\Module\Example\Administrator</code> namespace.</p></li><li class="listitem"><p><span class="bold"><strong>Plugin</strong></span>. The plugin <code class="code">plg_system_example</code> MUST have its classes under the namespace <code class="code">Joomla\Plugin\System\Example</code>. The namespace you MUST declare in the XML manifest is <code class="code">Joomla\Plugin\System\Example</code>. Even though you are severely restricted in the namespace prefix you can use, you MUST provide it in your XML manifest or your plugin won't work! The folder <code class="filename">plugins/system/example/src</code> is the root of the <code class="code">Joomla\Plugin\System\Example</code> namespace.</p></li><li class="listitem"><p><span class="bold"><strong>Template</strong></span>. Well, Joomla does NOT register a namespace for templates. You are encouraged to use namespaces for any template-specific code (you certainly have some helpers, don't you?) BUT Joomla won't facilitate you with any autoloading. You will have to register your template's namespace directly with the <code class="code">JLoader::registerPrefix</code> method. It is a good practice putting your namespaced PHP files in the <code class="filename">src</code> directory and use the namespace <code class="code">\Joomla\Template\Site\Something</code> for frontend templates and <code class="code">\Joomla\Template\Administrator\Something</code> for backend templates. Please note that there is no real guidance for the template names BUT we can infer what any future change adding namespace support to templates will most likely be based on how modules are namespaced and Joomla trying to have a modicum of consistency.</p></li></ul></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch02.html"><img src="images/prev.svg" alt="Prev"></a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch02.html"><img src="images/up.svg" alt="Up"></a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch02s02.html"><img src="images/next.svg" alt="Next"></a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;2.&nbsp;Basic concepts&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html"><img src="images/home.svg" alt="Home"></a></td><td width="40%" align="right" valign="top">&nbsp;2.&nbsp;Dependency Injection Container / Service Locator</td></tr></table></div></body></html>